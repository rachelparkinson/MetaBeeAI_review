# Notebooks

This folder contains two Jupyter notebooks that demonstrate how to merge multiple ASReview outputs into a single dataset and then perform analyses on the merged data. Below is a brief overview of each notebook and its purpose.

---

## 1. **01_merge_datasets.ipynb**

**Purpose**  
- Merges an `input_dataset.csv` with multiple CSV output files generated by ASReview (found in `../data/asreview_output`).
- Identifies and resolves any duplicate rows based on the `title` column.
- Generates two final CSV files:
  1. **`cleaned_merged_dataset.csv`** – The main dataset containing merged and deduplicated information.
  2. **`not_included_papers.csv`** – A list of papers that aren’t included in any domain.

**Key Steps**  
1. **Load Input Data**  
   - Reads `input_dataset.csv` from the `../data/` folder.
   - Displays the first few rows for a quick look.

2. **Merge ASReview Output Files**  
   - Iterates through subfolders in `../data/asreview_output`.
   - Reads each CSV file (e.g., `molec_CB.csv`, `indiv_SF.csv`, etc.).
   - Checks for `title` and `included` columns, then merges them into `input_df`.

3. **Save Merged Output**  
   - Creates `merged_dataset.csv` in the `../output/` folder.
   - Displays the head of the merged DataFrame.

4. **Handle Duplicate Rows**  
   - Detects duplicates based on the `title` column and consolidates them using a group-by.
   - Saves the cleaned result as `cleaned_merged_dataset.csv`.

5. **Identify Papers with No Domain**  
   - Checks if a paper was never marked as included (`NaN` in all domain columns).
   - Saves these papers to `not_included_papers.csv`.

**Output Files**  
- `../output/merged_dataset.csv`
- `../output/cleaned_merged_dataset.csv`
- `../output/not_included_papers.csv`

---

## 2. **02_review_output.ipynb**

**Purpose**  
- Performs analyses on the cleaned dataset (`cleaned_merged_dataset.csv`).
- Investigates domain coverage, reviewer agreement, and cross-domain overlaps.

**Key Steps**  
1. **Load Cleaned Dataset**  
   - Reads `cleaned_merged_dataset.csv` from `../output/`.

2. **Count Included Papers per Domain**  
   - Identifies columns for each domain (e.g., `molec_`, `subin_`, etc.).
   - Counts how many papers were marked as included (`1`) in each domain.
   - Produces a bar chart showing the counts.

3. **Reviewer Agreement**  
   - For each domain, calculates pairwise agreement between reviewers (e.g., `molec_A vs molec_B`).
   - Saves results to `pairwise_reviewer_agreement_with_proportion.csv`.
   - Computes the average proportion of agreement across all domains.

4. **Cross-Domain Relevance**  
   - Determines how often a paper is relevant to multiple domains.
   - Plots the distribution of papers across 1, 2, or more domains.

5. **Co-Occurrence Matrix**  
   - Creates a co-occurrence matrix for papers relevant in two or more domains.
   - Visualizes domain overlaps with a heatmap.

**Output Files**  
- `pairwise_reviewer_agreement_with_proportion.csv` – Contains pairwise reviewer agreement data.

---

## Usage Notes

1. **Recommended Order**  
   - Run `01_merge_datasets.ipynb` first to produce the cleaned dataset files.
   - Then run `02_review_output.ipynb` to generate summary statistics, plots, and reviewer agreement metrics.

2. **Dependencies**  
   - `pandas`
   - `matplotlib`
   - `seaborn` (used in `02_review_output.ipynb`)
   - Make sure to have these installed in your environment.

3. **Data Paths**  
   - The notebooks expect data in `../data/` and output to `../output/`.
   - Adjust file paths as needed if your directory structure differs.

---

**End of README**  
